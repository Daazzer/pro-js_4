# 第 27 章 工作者线程

允许把主线程的工作转嫁给独立的实体，而不会改变现有的单线程模型。特点是都独立于 JavaScript 的主执行环境

## 27.1 工作者线程简介

使用工作者线程，浏览器可以在原始页面环境之外再分配一个完全独立的二级子环境。这个子环境不能与依赖单线程交互的 API（如 DOM）互操作，但可以与父环境并行执行代码。

### 27.1.1 工作者线程与线程

- **工作者线程是以实际线程实现的** 例如，Blink 浏览器引擎实现工作者线程的 `WorkerThread` 就对应着底层的线程。
- **工作者线程并行执行** 虽然页面和工作者线程都是单线程 JavaScript 环境，每个环境中的指令则可以并行执行。
- **工作者线程可以共享某些内存** 工作者线程能够使用 `SharedArrayBuffer` 在多个环境间共享内容。虽然线程会使用锁实现并发控制，但 JavaScript 使用 `Atomics` 接口实现并发控制。
- **工作者线程不共享全部内存** 在传统线程模型中，多线程有能力读写共享内存空间。除了 `SharedArrayBuffer` 外，从工作者线程进出的数据需要复制或转移。
- **工作者线程不一定在同一个进程里** 通常，一个进程可以在内部产生多个线程。根据浏览器引擎的实现，工作者线程可能与页面属于同一进程，也可能不属于。例如，Chrome 的 Blink 引擎对 共享工作者线程和服务工作者线程使用独立的进程。
- **创建工作者线程的开销更大** 工作者线程有自己独立的事件循环、全局对象、事件处理程序和其他 JavaScript 环境必需的特性。创建这些结构的代价不容忽视

> **注意** 工作者线程相对比较重，不建议大量使用。

